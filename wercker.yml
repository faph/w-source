box: debian

build:
  steps:
  - arjen/hugo-build@1.11.0:
      version: "0.15"

publish:
  steps:
  - install-packages:
      packages: openssh-client git
  - wercker/add-ssh-key@1.0.3:
      keyname: github_publish
      host: github.com
  - wercker/add-to-known_hosts@2.0.1:
      hostname: github.com
      fingerprint: 34:5a:c1:b0:8f:a6:ac:e0:f0:a8:a5:44:7d:bb:a2:c4
  - script:
      name: push 
      code : |
        echo "Starting to push to GitHub..."
        #export GIT_SSH_COMMAND="ssh -i ~/.ssh/github_publish_PRIVATE"
        #$GIT_SSH_COMMAND
        echo "SSH config file"
        cat ~/.ssh/config
        echo "Trying to clone..."
        git clone git@github.com:faph/w.git /tmp/cloned-repo
  - lordlothar99/git-push@0.7.18:
      host: github.com
      repo: faph/w
      gh_pages: true
      gh_pages_domain: example.org
      basedir: public
      clean_removed_files: true